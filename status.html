<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <title>STATUS</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> </head>
  <script src="https://ajax.googleapis.com/ajax/libs/dojo/1.13.0/dojo/dojo.js" data-dojo-config="async: true, parseOnLoad: true"></script>
  <script>
    require([
      "dojo/store/CsvStore", 
      "dojo/dom", 
      "dojo/domReady!"
    ], function(CsvStore, dom) {

      // 定義檔案 ID 與 URL
      const fileId = "1dEFGUB9I7hvb5zX3wIWM3TR2AEABjEzU"; // 使用您提供的檔案 ID
      const fileUrl = `https://drive.google.com/uc?id=${fileId}&export=download`;

      // 初始化 CsvStore 並抓取資料
      function loadCsv() {
        const store = new CsvStore({
          url: fileUrl,
          label: "service" // 使用 service 欄位作為標籤
        });

        // 抓取資料
        store.fetch({
          onComplete: function(items) {
            displayData(items);
          },
          onError: function(error) {
            console.error("Error loading CSV:", error);
            dom.byId("output").innerText = "資料載入失敗，請檢查網路或檔案狀態。";
          }
        });
      }

      // 顯示資料
      function displayData(items) {
        const output = items.map(function(item) {
          return `
            Service: ${item.service},
            Name: ${item.name},
            Status: ${item.status},
            Update Time: ${item.updatetime},
            Period: ${item.period}
          `;
        }).join("\n");

        // 將結果顯示到頁面
        dom.byId("output").innerText = output;
      }

      // 初始化時執行
      loadCsv();

      // 設定每 5 秒重新抓取一次
      setInterval(loadCsv, 5000);
    });
  </script>
</head>
<body>
  <div>
    <h1>CSV 資料抓取結果</h1>
    <pre id="output">正在載入資料...</pre>
  </div>
</body>
</html>
